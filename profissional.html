<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nutrimente - Cl√≠nica de Psicologia Nutricional</title>
  <meta name="description" content="Cl√≠nica de Psicologia Nutricional que une acolhimento e ci√™ncia para promover sa√∫de mental e bem-estar.">

  <style>
    /* Dropdown do usu√°rio (menu sair) */
    .user-menu {
      position: relative;
    }

    .user-dropdown {
      display: none;
      position: absolute;
      top: 45px;
      right: 0;
      background: #fff;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 2000;
    }

    .user-menu.active .user-dropdown {
      display: block;
    }

    .user-dropdown button {
      background: #f44336;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
    }

    .user-dropdown button:hover {
      background: #d9362b;
    }

    :root{
      --bg: #f7f9fc;
      --card:#fff;
      --accent:#255bd9;
      --accent-green:#57C441;
      --text:#102C6F;
      --radius:12px;
      font-family: Inter, system-ui, sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{background:var(--bg);color:var(--text);line-height:1.6;}

    header{
      background:var(--accent); color:#fff;
      padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;
      box-shadow:0 3px 8px rgba(0,0,0,0.1);
    }
    .brand{display:flex;align-items:center;gap:.6rem;font-weight:700;font-size:1.25rem;color:#fff;text-decoration:none;}
    .logo-img{width:50px;height:50px;border-radius:10px;object-fit:cover}

    nav{display:flex;align-items:center;}
    nav a{color:#fff;text-decoration:none;margin-left:1.5rem;font-weight:600;transition:opacity .3s;}
    nav a:hover{opacity:.85}

    .menu-toggle{display:none;background:none;border:none;color:#fff;font-size:1.6rem;cursor:pointer;}
    @media(max-width:768px){ .menu-toggle{display:block} nav{flex-direction:column; position:absolute; top:70px; left:0; width:100%; background:var(--accent); display:none} nav.active{display:flex} nav a{margin:1rem 0;} }

    .login-btn{background:var(--accent-green); color:#fff; padding:.5rem 1rem;border:none;border-radius:8px;font-weight:700;cursor:pointer;}
    .login-btn:hover{background:#4eb13a}

    section{max-width:1100px;margin:2.5rem auto;padding:1rem 2rem;}

    h2{color:var(--accent); margin-bottom:1rem; border-left:6px solid var(--accent-green); padding-left:.5rem; font-size:1.4rem}

    .services{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.2rem;}
    .service{background:var(--card);padding:1.5rem;border-radius:var(--radius);border:1px solid #e0e6f1;box-shadow:0 4px 12px rgba(0,0,0,0.05);}

    /* O que √© - com imagem √† direita */
    .oque-container{display:flex;align-items:center;gap:2rem}
    .oque-container img{width:320px;border-radius:12px;object-fit:cover;box-shadow:0 4px 12px rgba(0,0,0,.1)}
    @media(max-width:768px){ .oque-container{flex-direction:column;text-align:center} .oque-container img{width:100%} }

    /* Agendamento */
    .agenda-wrapper{max-width:700px;background:var(--card);padding:2rem;border-radius:var(--radius);border:1px solid #e0e6f1;box-shadow:0 6px 16px rgba(0,0,0,0.06)}
    label{font-weight:600;margin-bottom:.3rem;display:block}
    input, select, textarea{width:100%;padding:.75rem;border-radius:var(--radius);border:1px solid #ccc;font-size:1rem;margin-bottom:.5rem}
    .horarios-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.6rem;margin:1rem 0;}
    .horario-btn{padding:.8rem;border-radius:var(--radius);border:2px solid var(--accent);background:var(--bg);color:var(--text);font-weight:600;cursor:pointer}
    .horario-btn.selecionado{background:var(--accent-green);color:#fff;border-color:var(--accent-green)}

    .meus-agendamentos{margin-top:1.2rem;background:var(--card);padding:1rem;border-radius:var(--radius);border:1px solid #e0e6f1;box-shadow:0 4px 12px rgba(0,0,0,0.05)}
    .cancelar-btn{background:#f44336;color:#fff;border:none;padding:.3rem .6rem;border-radius:6px;margin-left:10px;cursor:pointer}

    /* botao minhas consultas que abre outra pagina */
    .agendamentos{max-width:1100px;margin:0 auto;padding:0 2rem}
    .btn-consultas{display:inline-flex;align-items:center;background:#1c63d5;color:#fff;padding:14px 24px;border-radius:10px;border:none;font-size:18px;font-weight:600;cursor:pointer;margin:20px 0}
    .btn-consultas:hover{background:#0e4fb1}

    /* modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;justify-content:center;align-items:center;z-index:1000}
    .modal-content{background:#fff;padding:2rem;border-radius:12px;max-width:420px;width:92%;position:relative;box-shadow:0 6px 16px rgba(0,0,0,.2)}
    .modal-close{position:absolute;top:12px;right:15px;background:none;border:none;font-size:1.6rem;cursor:pointer;color:#555}

    .user-menu{position:relative;display:inline-flex;align-items:center;gap:.5rem;cursor:pointer}
    .avatar{width:36px;height:36px;border-radius:50%;background:#fff;color:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:700}

    footer{background:var(--accent);color:#fff;text-align:center;padding:2rem 1rem;margin-top:2.5rem;font-size:0.95rem}
    footer a{color:var(--accent-green);text-decoration:none;font-weight:600}
  </style>
</head>

<body>
  <header>
    <a class="brand" href="#">
      <img src="img/LogoNutrimente.png" alt="Logo da Nutrimente" class="logo-img">
      Nutrimente
    </a>

    <button class="menu-toggle" id="menuToggle">‚ò∞</button>

    <nav id="menuNav">
      <a href="#oque">O que √©?</a>
      <a href="#equipe">Equipe</a>
      <a href="#servicos">Servi√ßos</a>
      <a href="#agendamento">Agendamento</a>
      <a href="#contato">Contato</a>
    </nav>

    <button class="login-btn" id="abrirLogin">Login</button>
  </header>

  <!-- BOT√ÉO "Minhas pr√≥ximas consultas" - fica escondido enquanto n√£o logado -->
  <div class="agendamentos" id="agendamentos" style="display:none;">
    <button class="btn-consultas" onclick="window.location.href='proximas-consultas.html'">
        Minhas pr√≥ximas consultas
    </button>
  </div>



      <!-- √Årea de exibi√ß√£o de agendamentos do usu√°rio (vis√≠vel se houver) -->
      <div class="meus-agendamentos" id="meusAgendamentos" style="display:none;">
        <h3>Meus agendamentos</h3>
        <div id="listaAgendamentos"></div>
      </div>
    </div>
  </section>

  <!-- Modal Login / Cadastro -->
  <div class="modal" id="modalLogin">
    <div class="modal-content">
      <button id="fecharModal" class="modal-close">√ó</button>
      <h2 id="tituloLogin">Entrar</h2>

      <div id="formLogin">
        <input type="email" id="loginEmail" placeholder="Email" required><br>
        <input type="password" id="loginSenha" placeholder="Senha" required><br>
        <button id="btnLogin" class="login-btn" style="width:100%;">Entrar</button>
        <p style="margin-top:.6rem">Ainda n√£o tem conta?
          <span id="mostrarCadastro" style="color:var(--accent);cursor:pointer;font-weight:600"> Cadastre-se</span>
        </p>
      </div>

      <div id="formCadastro" style="display:none;">
        <h3 style="margin-bottom:.5rem">Crie sua conta</h3>
        <input type="text" id="cadastroNome" placeholder="Nome completo" required><br>
        <input type="email" id="cadastroEmail" placeholder="Email" required><br>
        <input type="password" id="cadastroSenha" placeholder="Senha (m√≠n 6 chars)" required><br>
        <button id="btnCadastro" class="login-btn" style="width:100%;">Cadastrar</button>
        <p style="margin-top:.6rem">J√° tem conta?
          <span id="mostrarLogin" style="color:var(--accent);cursor:pointer;font-weight:600"> Entrar</span>
        </p>
      </div>
    </div>
  </div>

  <footer id="contato">
    <p>¬©Ô∏è 2025 Nutrimente. Todos os direitos reservados.</p>
    <p>Contato: <a href="mailto:contato@nutrimente.com.br">contato@nutrimente.com.br</a></p>
  </footer>

<script>
  // ====== Elementos ======
  const menuToggle = document.getElementById('menuToggle');
  const menuNav = document.getElementById('menuNav');
  const modal = document.getElementById('modalLogin');
  const abrir = document.getElementById('abrirLogin');
  const fechar = document.getElementById('fecharModal');
  const formLogin = document.getElementById('formLogin');
  const formCadastro = document.getElementById('formCadastro');
  const mostrarCadastro = document.getElementById('mostrarCadastro');
  const mostrarLogin = document.getElementById('mostrarLogin');
  const titulo = document.getElementById('tituloLogin');

  const agendamentosBtnWrapper = document.getElementById('agendamentos');
  const meusAgendamentosBox = document.getElementById('meusAgendamentos');
  const listaAgendamentos = document.getElementById('listaAgendamentos');

  // form agenda
  const horarios = document.querySelectorAll('.horario-btn');
  const formAgenda = document.getElementById('formAgenda');

  // usu√°rios / sess√£o
  let usuarioAtual = JSON.parse(localStorage.getItem('usuarioLogado') || 'null');

  // ====== Menu mobile ======
  menuToggle.onclick = () => menuNav.classList.toggle('active');

  // ====== Modal Login abrir/fechar ======
  abrir.onclick = () => modal.style.display = 'flex';
  fechar.onclick = () => modal.style.display = 'none';
  window.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none'; });

  mostrarCadastro.onclick = () => { formLogin.style.display = 'none'; formCadastro.style.display = 'block'; titulo.textContent = 'Cadastro'; };
  mostrarLogin.onclick = () => { formLogin.style.display = 'block'; formCadastro.style.display = 'none'; titulo.textContent = 'Entrar'; };

  // ====== Valida√ß√µes simples ======
  function validarEmail(email){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email); }
  function validarSenha(senha){ return /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(senha); }
  function validarNome(nome){ return /^[A-Za-z√Ä-√ø\s]{3,}$/.test(nome); }
  function validarTelefone(tel){ return /^(\(?\d{2}\)?\s?)?\d{4,5}-?\d{4}$/.test(tel); }
  function mostrarErro(msg){ alert("‚ö†Ô∏è " + msg); }

  // ====== Cadastro ======
  document.getElementById('btnCadastro').onclick = () => {
    const nome = document.getElementById('cadastroNome').value.trim();
    const email = document.getElementById('cadastroEmail').value.trim();
    const senha = document.getElementById('cadastroSenha').value;

    if (!validarNome(nome)) return mostrarErro('Digite um nome v√°lido (m√≠nimo 3 letras).');
    if (!validarEmail(email)) return mostrarErro('Digite um email v√°lido.');
    if (!validarSenha(senha)) return mostrarErro('A senha deve ter ao menos 6 caracteres, incluindo letras e n√∫meros.');

    let users = JSON.parse(localStorage.getItem('usuarios') || '[]');
    if (users.find(u => u.email === email)) return mostrarErro('Email j√° cadastrado!');
    users.push({ nome, email, senha, agendamentos: [] });
    localStorage.setItem('usuarios', JSON.stringify(users));

    alert('‚úÖ Cadastro realizado! Fa√ßa login.');
    formCadastro.style.display = 'none';
    formLogin.style.display = 'block';
    titulo.textContent = 'Entrar';
    // opcional: preenche campo de login
    document.getElementById('loginEmail').value = email;
  };

  // ====== Login ======
  document.getElementById('btnLogin').onclick = () => {
    const email = document.getElementById('loginEmail').value.trim();
    const senha = document.getElementById('loginSenha').value;
    if (!validarEmail(email)) return mostrarErro('Email inv√°lido.');
    if (senha.length < 1) return mostrarErro('Digite sua senha.');

    const users = JSON.parse(localStorage.getItem('usuarios') || '[]');
    const user = users.find(u => u.email === email && u.senha === senha);
    if (!user) return mostrarErro('Credenciais inv√°lidas.');

    usuarioAtual = user;
    localStorage.setItem('usuarioLogado', JSON.stringify(user));
    modal.style.display = 'none';
    atualizarSaudacao();
    // mostrar o bot√£o de consultas
    agendamentosBtnWrapper.style.display = 'block';
  };

  // ====== Atualiza sauda√ß√£o / menu do usu√°rio ======
  function atualizarSaudacao(){
    // remove se j√° existe
    const existente = document.querySelector('.user-menu');
    if (existente) existente.remove();

    if (usuarioAtual) {
      // esconde bot√£o de abrir login
      abrir.style.display = 'none';

      // cria user menu com avatar e logout
      const userMenu = document.createElement('div');
      userMenu.className = 'user-menu';

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = usuarioAtual.nome.split(' ').map(p => p[0]).join('').substring(0,2).toUpperCase();

      const name = document.createElement('span');
      name.style.color = '#fff';
      name.style.fontWeight = '700';
      name.style.marginLeft = '6px';
      name.textContent = usuarioAtual.nome.split(' ')[0] + ' ‚ñæ';

      const dropdown = document.createElement('div');
      dropdown.className = 'user-dropdown';

      const sairBtn = document.createElement('button');
      sairBtn.textContent = 'Sair';
      sairBtn.onclick = () => {
        localStorage.removeItem('usuarioLogado');
        usuarioAtual = null;
        userMenu.remove();
        abrir.style.display = 'inline-block';
        agendamentosBtnWrapper.style.display = 'none';
        meusAgendamentosBox.style.display = 'none';
      };

      dropdown.appendChild(sairBtn);
      userMenu.appendChild(avatar);
      userMenu.appendChild(name);
      userMenu.appendChild(dropdown);

      document.querySelector('header').appendChild(userMenu);
      userMenu.onclick = () => userMenu.classList.toggle('active');

      // mostra o bot√£o de "Minhas pr√≥ximas consultas"
      agendamentosBtnWrapper.style.display = 'block';

      // carregar agendamentos do usu√°rio
      carregarAgendamentos();
    } else {
      // n√£o logado
      abrir.style.display = 'inline-block';
      agendamentosBtnWrapper.style.display = 'none';
      meusAgendamentosBox.style.display = 'none';
    }
  }

  // ====== Hor√°rios sele√ß√£o ======
  horarios.forEach(btn => btn.addEventListener('click', () => {
    if (btn.classList.contains('reservado')) return;
    horarios.forEach(b => b.classList.remove('selecionado'));
    btn.classList.add('selecionado');
  }));

  // ====== Enviar agendamento ======
  formAgenda.addEventListener('submit', e => {
    e.preventDefault();
    if (!usuarioAtual) return mostrarErro('Fa√ßa login para agendar.');

    const data = document.getElementById('data').value;
    const nome = document.getElementById('nome').value.trim();
    const email = document.getElementById('email').value.trim();
    const telefone = document.getElementById('telefone').value.trim();
    const horarioSelecionado = document.querySelector('.horario-btn.selecionado');

    if (!data) return mostrarErro('Selecione uma data.');
    // valida data futura
    const hoje = new Date(); hoje.setHours(0,0,0,0);
    if (new Date(data) < hoje) return mostrarErro('Selecione uma data futura.');
    if (!horarioSelecionado) return mostrarErro('Escolha um hor√°rio.');
    if (!validarNome(nome)) return mostrarErro('Nome inv√°lido.');
    if (!validarEmail(email)) return mostrarErro('Email inv√°lido.');
    if (!validarTelefone(telefone)) return mostrarErro('Telefone inv√°lido. Ex: (11) 98765-4321');

    const agendamento = { data, hora: horarioSelecionado.dataset.hora, nome, email, telefone };

    let users = JSON.parse(localStorage.getItem('usuarios') || '[]');
    const idx = users.findIndex(u => u.email === usuarioAtual.email);
    if (idx !== -1) {
      users[idx].agendamentos.push(agendamento);
      usuarioAtual = users[idx];
      localStorage.setItem('usuarios', JSON.stringify(users));
      localStorage.setItem('usuarioLogado', JSON.stringify(usuarioAtual));
    }

    alert('‚úÖ Agendamento confirmado!');
    formAgenda.reset();
    horarios.forEach(b => b.classList.remove('selecionado'));
    carregarAgendamentos();
  });

  // ====== Carregar agendamentos do usu√°rio ======
  function carregarAgendamentos(){
    if (!usuarioAtual?.agendamentos?.length) {
      meusAgendamentosBox.style.display = 'none';
      listaAgendamentos.innerHTML = '';
      return;
    }

    meusAgendamentosBox.style.display = 'block';
    listaAgendamentos.innerHTML = '';

    usuarioAtual.agendamentos.forEach((a, i) => {
      const item = document.createElement('div');
      item.style.padding = '8px 0';
      item.style.borderBottom = '1px solid #eee';
      item.innerHTML = `üìÖ <strong>${a.data}</strong> √†s <strong>${a.hora}</strong> ‚Äî ${a.nome} (${a.telefone})
        <button class="cancelar-btn" data-index="${i}">Cancelar</button>`;
      listaAgendamentos.appendChild(item);
    });

    document.querySelectorAll('.cancelar-btn').forEach(btn => {
      btn.onclick = () => {
        if (!confirm('Deseja realmente cancelar este agendamento?')) return;
        const idx = +btn.dataset.index;
        usuarioAtual.agendamentos.splice(idx, 1);
        let users = JSON.parse(localStorage.getItem('usuarios') || '[]');
        const uidx = users.findIndex(u => u.email === usuarioAtual.email);
        if (uidx !== -1) users[uidx] = usuarioAtual;
        localStorage.setItem('usuarios', JSON.stringify(users));
        localStorage.setItem('usuarioLogado', JSON.stringify(usuarioAtual));
        carregarAgendamentos();
      };
    });
  }

  // inicializa√ß√£o: se j√° tem usu√°rio no localStorage, atualiza UI
  atualizarSaudacao();

</script>
</body>
</html>
